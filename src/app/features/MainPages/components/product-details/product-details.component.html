@if ((product$ | async); as res) {
<section class="bg-white">
    <div class="container mx-auto px-4 py-8">
        <div class="grid md:grid-cols-2 gap-8">
            <!-- Gallery -->
            <div>
                <img [src]="res.data.imageCover || '/images/img5.avif'" [alt]="res.data.title"
                    class="w-full rounded-xl border object-cover" />
                @if (res.data.images?.length) {
                <div class="grid grid-cols-4 gap-3 mt-3">
                    @for (img of res.data.images; track img) {
                    <img [src]="img" class="w-full h-20 object-cover rounded-lg border" />
                    }
                </div>
                }
            </div>

            <!-- Info -->
            <div>
                <h1 class="text-2xl md:text-3xl font-bold text-gray-900">{{ res.data.title }}</h1>
                <div class="mt-2 text-sm text-gray-600">{{ res.data.description }}</div>
                <div class="mt-3 flex items-center gap-3">
                    <span class="text-emerald-700 text-2xl font-semibold">{{ (res.data.priceAfterDiscount ||
                        res.data.price) | currency }}</span>
                    <span class="text-xs text-gray-500"><i class="fa-solid fa-star text-amber-400"></i> {{
                        res.data.ratingsAverage || 0 }}</span>
                </div>
                <div class="mt-6 flex gap-3">
                    <button type="button" (click)="addToCart(res.data._id)"
                        class="inline-flex items-center gap-2 px-4 py-2 rounded-md bg-emerald-600 text-white hover:bg-emerald-700">
                        <i class="fa-solid fa-cart-plus"></i>
                        <span>Add to cart</span>
                    </button>
                    <button type="button" (click)="toggleWishlist(res.data._id)"
                        class="inline-flex items-center gap-2 px-4 py-2 rounded-md border transition-all duration-200 hover:scale-105"
                        [class.bg-emerald-100]="(wishlist.ids$ | async)?.has(res.data._id)"
                        [class.border-emerald-600]="(wishlist.ids$ | async)?.has(res.data._id)"
                        [class.text-emerald-700]="(wishlist.ids$ | async)?.has(res.data._id)"
                        [class.hover:bg-gray-50]="!(wishlist.ids$ | async)?.has(res.data._id)"
                        [class.hover:bg-emerald-100]="(wishlist.ids$ | async)?.has(res.data._id)">
                        <i class="fa-heart" [class.fa-solid]="(wishlist.ids$ | async)?.has(res.data._id)"
                            [class.fa-regular]="!(wishlist.ids$ | async)?.has(res.data._id)"></i>
                        <span>{{ (wishlist.ids$ | async)?.has(res.data._id) ? 'In Wishlist' : 'Add to Wishlist'
                            }}</span>
                    </button>
                </div>
                <div class="mt-6 text-sm text-gray-600">
                    <p>Category: <span class="font-medium text-gray-900">{{ res.data.category?.name }}</span></p>
                    <p>Brand: <span class="font-medium text-gray-900">{{ res.data.brand?.name }}</span></p>
                </div>
            </div>
        </div>
    </div>
</section>
}